<?php

namespace Utilisateurs\UtilisateursBundle\Repository;

use Doctrine\ORM\EntityRepository;

/**
 * UtilisateursRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class UtilisateursRepository extends EntityRepository
{
    public function getAllMarques() 
    {
        $qb = $this->createQueryBuilder('u')
                ->select('u')
                ->where('u.marque != :null')
                ->setParameter('null', 'NULL')
                ->orderBy('u.id', 'DESC')
        ;
        return $qb->getQuery()->getResult();
    }

    public function getUserById($id)
    {
        $qb = $this->createQueryBuilder('u')
            ->select('u')
            ->where('u.id = :id')
            ->setParameter('id', $id)
        ;
        return $qb->getQuery()->getResult();
    }

    public function getUserByParrain()
    {
        $qb = $this->createQueryBuilder('u')
            ->select('u')
            ->where('u.codeparrain != :code')
            ->andWhere('LENGTH(u.codeparrain) = :value')
            ->setParameter('code', "")
            ->setParameter('value', 7)
        ;
        return $qb->getQuery()->getResult();
    }

    public function getUserByCode($code)
    {
        $qb = $this->createQueryBuilder('u')
            ->select('u')
            ->where('u.code = :code')
            ->setParameter('code', $code)
        ;
        return $qb->getQuery()->getResult();
    }


}
